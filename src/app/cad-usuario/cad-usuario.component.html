<!--
<mat-drawer-container   [hasBackdrop]=true>
  <mat-drawer #drawer  class="largDrawer"> 
    <button mat-icon-button (click)="drawer.toggle()" color="primary">
      <mat-icon>close</mat-icon>
    </button> 

    <br>
    Santech 2.0
    
    <br> 
    <button mat-button [matMenuTriggerFor]="menuP">Menu ></button>
    <mat-menu #menuP="matMenu">
      <button mat-menu-item [matMenuTriggerFor]="cadastros">Cadastros</button>
      <button mat-menu-item [matMenuTriggerFor]="relatorios">Relatórios</button>
    </mat-menu>
    
    <mat-menu #cadastros="matMenu">
      <button mat-menu-item [matMenuTriggerFor]="pessoas">Pessoas</button>
      <button mat-menu-item [matMenuTriggerFor]="tabelas">Tabelas</button>
      <button mat-menu-item [matMenuTriggerFor]="movimentos">Movimentos</button>
      <button mat-menu-item>Cálculos</button>

    </mat-menu>
    
    <mat-menu #relatorios="matMenu">
      <button mat-menu-item>Saldo de Estoque</button>
      <button mat-menu-item>Contas Contábeis</button> 
    </mat-menu>
    
    <mat-menu #pessoas="matMenu">
      <button mat-menu-item>Usuários</button>
      <button mat-menu-item>Fornecedores</button>
      <button mat-menu-item>Clientes</button>  
    </mat-menu>
    
    <mat-menu #tabelas="matMenu">
      <button mat-menu-item>Centros de Custo</button>
      <button mat-menu-item>Classes de Materiais</button>
      <button mat-menu-item>Tipo de Máquina</button>  
    </mat-menu>
    
    <mat-menu #movimentos="matMenu">
      <button mat-menu-item>Requisição de Materiais</button>
      <button mat-menu-item>Notas Fiscais</button>
      <button mat-menu-item>Contas Contábeis</button>

    </mat-menu>  

  </mat-drawer>
  <mat-drawer-content> 

<mat-toolbar color="primary"  >

      <mat-toolbar-row>
          <button mat-icon-button class="example-icon" (click)="drawer.toggle()" aria-label="Example icon-button with menu icon">
            <mat-icon>menu</mat-icon>
          </button>
          <span>Santech 2.0</span>  
          <span class="example-spacer"></span>  
          <button mat-icon-button class="example-icon favorite-icon"  aria-label="Example icon-button with heart icon">
            <mat-icon>person</mat-icon>
          </button> 

          <button mat-icon-button [matMenuTriggerFor]="menu" aria-label="Example icon-button with a menu">
            <mat-icon>more_vert</mat-icon>
          </button>
          <mat-menu #menu="matMenu">
            <button mat-menu-item>
              <mat-icon>dialpad</mat-icon>
              <span>Redial</span>
            </button>
            <button mat-menu-item disabled>
              <mat-icon>voicemail</mat-icon>
              <span>Check voice mail</span>
            </button>
            <button mat-menu-item>
              <mat-icon>notifications_off</mat-icon>
              <span>Disable alerts</span>
            </button>
          </mat-menu>  

        <button mat-icon-button class="example-icon" aria-label="Example icon-button with share icon">
          <mat-icon>share</mat-icon>
        </button>

      </mat-toolbar-row> 

      <mat-toolbar-row>
          <button mat-button [matMenuTriggerFor]="menuP">Menu ></button>
          <mat-menu #menuP="matMenu">
            <button mat-menu-item [matMenuTriggerFor]="cadastros">Cadastros</button>
            <button mat-menu-item [matMenuTriggerFor]="relatorios">Relatórios</button>
          </mat-menu>
          
          <mat-menu #cadastros="matMenu">
            <button mat-menu-item [matMenuTriggerFor]="pessoas">Pessoas</button>
            <button mat-menu-item [matMenuTriggerFor]="tabelas">Tabelas</button>
            <button mat-menu-item [matMenuTriggerFor]="movimentos">Movimentos</button>
            <button mat-menu-item>Cálculos</button>
 
          </mat-menu>
          
          <mat-menu #relatorios="matMenu">
            <button mat-menu-item>Saldo de Estoque</button>
            <button mat-menu-item>Contas Contábeis</button> 
          </mat-menu>
          
          <mat-menu #pessoas="matMenu">
            <button mat-menu-item>Usuários</button>
            <button mat-menu-item>Fornecedores</button>
            <button mat-menu-item>Clientes</button>  
          </mat-menu>
          
          <mat-menu #tabelas="matMenu">
            <button mat-menu-item>Centros de Custo</button>
            <button mat-menu-item>Classes de Materiais</button>
            <button mat-menu-item>Tipo de Máquina</button>  
          </mat-menu>
          
          <mat-menu #movimentos="matMenu">
            <button mat-menu-item>Requisição de Materiais</button>
            <button mat-menu-item>Notas Fiscais</button>
            <button mat-menu-item>Contas Contábeis</button>
 
          </mat-menu> 

    </mat-toolbar-row>

</mat-toolbar>  

-->

<div class="formatoTela" >  
  <mat-card class="mat-elevation-z5" *ngIf="onEdit"   >    
    
    <mat-card-header>
      <h1>Cadastro de Usuarios</h1>             
    </mat-card-header>
    
        <mat-card-content> 

            <!--Formulário de Manutenção de Usuário-->
              <form class="example-form" [formGroup]="userForm" (ngSubmit) = "onSubmit()">                        

                    <button mat-raised-button  color="warn" (click)="cancel()"   class="espacoCampo"  > <mat-icon>search</mat-icon> Pesquisar</button>    
                    <button mat-raised-button  type="submit" color="primary"   class="espacoCampo " [disabled]="!userForm.valid" >Gravar
                        <mat-icon>done</mat-icon> 
                    </button>             
                    <button mat-raised-button    *ngIf="onAlt"  class="espacoCampo cor" (click)="openDialog2(vId)"><mat-icon>delete</mat-icon>Excluir</button>    
                  
                    <mat-form-field class="example-full-width campo" >
                      <mat-label>Id</mat-label>
                      <input matInput disabled [value]="vId" >
                    </mat-form-field> 
                
                    <br>
                    <br>

                    <mat-form-field class="example-full-width campo " >
                      <mat-label>Nome*</mat-label>
                      <input matInput placeholder="Nome" name="vNome" id="vNome" formControlName="vNome"  > 
                      <mat-icon matSuffix >person</mat-icon> 
                      <mat-error *ngIf="userForm.controls.vNome.hasError('required')">
                          Informe o nome
                      </mat-error>
                      
                      <!--
                      <mat-error *ngIf="userForm.controls.vNome.hasError('minlength')">nxsty0-*-
                        Nome deve  ter {{userForm.controls.vNome.errors.minlength.requiredLength}}
                        ou mais caracteres. Tamanho Atual:  {{ userForm.controls.vNome.errors.minlength.actualLength}}
                      </mat-error>                       
                      -->

                    </mat-form-field>
                    <br>


                    <mat-form-field class="example-full-width campo " >
                      <mat-label>Senha*</mat-label>
                      <input matInput type="password"   placeholder="Nome" name="vPwd" id="vPwd" formControlName="vPwd"  > 
                      <mat-icon matSuffix >password</mat-icon> 
                      <mat-error *ngIf="userForm.controls.vPwd.hasError('required')">
                          Informe a senha
                      </mat-error> 
                    </mat-form-field>             

                    <br>

                    <mat-form-field class="example-full-width campo ">
                      <mat-label>E-mail</mat-label>
                      <input matInput placeholder="Email"  id="vEmail" formControlName="vEmail" >
                      <mat-icon matSuffix >email</mat-icon>    
                      <mat-error *ngIf="userForm.controls.vEmail.hasError('required')">
                        Informe o email
                      </mat-error>   
                    </mat-form-field>

                    <br>  
                    <input   type="hidden"    name="vId"   > 
                   

                    <mat-form-field class="example-full-width campo">
                      <mat-label>Filial Padrão</mat-label>
                      <mat-select formControlName="vFilialPad"  >                              
                        <mat-option *ngFor="let tpP of vFiliaisUsu" [value]="tpP.id">
                          {{tpP.descricao}}
                        </mat-option>
                      </mat-select> 
                    </mat-form-field>    

              </form>      

        </mat-card-content>   
  </mat-card>            
</div>  

<mat-tab-group animationDuration="0ms" *ngIf="onEdit" class="alignTable">

  <!--Detalhe da Manutenção do Grupos de Usuários-->
  <mat-tab label="Grupos">
       
        <mat-card  *ngIf="aGrupo.length > -1" >  
            <mat-card-header>
              <h1>Grupos do usuário</h1>                     
            </mat-card-header>
            
            <button mat-raised-button   class="espacoCampo cor" (click)="insereAgrupos()"><mat-icon>add</mat-icon>Grupo</button>                    
            <br>
            <br>
            <app-grupo 
              *ngFor="let g of aGrupo; let i=index"  
              [grupo]="g" 
              (removeGrupo)="deleteGrupo(i)" 
              (updateGrupo)="updateGrupo($event, i)"
              > 
            </app-grupo>
        </mat-card>  
    
  </mat-tab>


  <!--Detalhe da Manutenção de Filiais do usuário-->
  <mat-tab label="Filiais">

      <mat-card  *ngIf="aGrupo.length > -1" >  
        <mat-card-header>
          <h1>Filiais</h1>                     
        </mat-card-header>

        <section class="example-section">
          <span class="example-list-section">
              <h1> 
              <mat-checkbox class="example-margin"
                            [checked]="todosMarcados"
                            [color]="filial.cor"
                            [indeterminate]="marcaParcialChk()"
                            (change)="marcaTodos($event.checked)">
                {{filial.nome}}
              </mat-checkbox>   
            </h1>
            </span>

            <span class="example-list-section">
              <ul>
                <li *ngFor="let f of filial.filiais"> 
                    <h1> 
                        <mat-checkbox class="example-margin" 
                                  [(ngModel)]="f.todos" 
                                  [color]="f.cor" 
                                  (ngModelChange)="atualizaTodosChk()">
                                  {{f.nome}}
                      </mat-checkbox>  
                  </h1> 
                </li>
              </ul>
            </span>   
          
        </section> 


      </mat-card>    

  </mat-tab>
</mat-tab-group> 

<br><br> 

<!-- Tela Principal com Grid de usuários -->
<mat-card  class="mat-elevation-z5 formatoTela" *ngIf="!onEdit" > 
  <mat-card-header>
    <mat-card-title>Usuários</mat-card-title>
  </mat-card-header>
  <form class="example-form"> 

          <mat-form-field class="example-full-width campo">
            <mat-label>Pesquise por Nome</mat-label>
            <input matInput placeholder="Pesquise por nome "  [(ngModel)]="pesqNome" name="pesqNome"    > 
            <mat-icon matSuffix >person</mat-icon>
          </mat-form-field>
          <br>

          <mat-form-field class="example-full-width campo">
            <mat-label>Pesquise por E-mail</mat-label> 
            <input matInput placeholder="Pesquise por e-mail"  [(ngModel)]="pesqEmail" name="pesqEmail"     >
            <mat-icon matSuffix >email</mat-icon>  
          </mat-form-field>
          <br>  

          <br>
          <button mat-raised-button   class="espacoCampo" color="warn" (click)="pesqByName()">   
            <mat-icon>person</mat-icon> Pesquisar
          </button> 
          <button mat-raised-button class="espacoCampo" color="primary" (click)="limpaPesq()">   
            <mat-icon>search</mat-icon> Limpar
          </button>  

  </form> 
</mat-card> 
<!-- Tela Principal com Grid de usuários -->            
<mat-card class="mat-elevation-z5 formatoTela" *ngIf="!onEdit" >

      <mat-card-header>
        <mat-card-title>Dados dos usuários</mat-card-title>
      </mat-card-header>
      <mat-card-content >  
            <div class="alignTable">
                  <table mat-table [dataSource]="aUsers" class="mat-elevation-z8" *ngIf="!onEdit"> 
                  
                        <ng-container matColumnDef="editar" class="espacoCampo" >
                          <th mat-header-cell *matHeaderCellDef class="campoGrid"  > Editar </th>
                          <td mat-cell *matCellDef="let element"> <button mat-mini-fab color="accent" (click)="editUser(element)"><mat-icon>edit</mat-icon></button> </td>
                        </ng-container> 

                        <!-- Id Column -->
                        <ng-container matColumnDef="id"  class="espacoCampo">
                          <th mat-header-cell *matHeaderCellDef class="campoGrid"> Id</th>
                          <td mat-cell *matCellDef="let element" class="campoGrid"> {{element.id}} </td>
                        </ng-container>
                      
                        <!-- Nome Column -->
                        <ng-container matColumnDef="nome" class="espacoCampo" >
                          <th mat-header-cell *matHeaderCellDef class="campoGrid"> Nome </th>
                          <td mat-cell *matCellDef="let element"  class="campoGrid"> {{element.nome}} </td>
                        </ng-container> 
                      
                        
                        <ng-container matColumnDef="email" class="espacoCampo">
                          <th mat-header-cell *matHeaderCellDef class="campoGrid"> Email </th>
                          <td mat-cell *matCellDef="let element"  class="campoGrid"> {{element.email}} </td>
                        </ng-container>   
                      
                        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>  

                  </table> 
            </div>  
      </mat-card-content>  

      <mat-card-actions>  

          <button mat-raised-button color="primary" (click)="addUser()"  class="espacoCampo"   >   
            <mat-icon>add</mat-icon> Novo
          </button>    

          <button mat-raised-button class="cor espacoCampo" color="primary" (click)="atualizaUsers()"   >   
            <mat-icon>search</mat-icon> Exibir Todos
          </button> 

          
          <button mat-raised-button class="espacoCampo" color="accent" (click)="pesqByNamePag(-1)"  >   
            <mat-icon>keyboard_arrow_left</mat-icon>    
          </button> 

          <button mat-raised-button  class="espacoCampo" color="accent"   (click)="pesqByNamePag(1)"  >   
            <mat-icon>keyboard_arrow_right</mat-icon>    
          </button>  
         
      </mat-card-actions> 

</mat-card>  

<!--

</mat-drawer-content>
</mat-drawer-container>



  
                    <!--
                    <mat-card class="mat-elevation-z5"  *ngIf="onEdit"  >   
                      <mat-card-header>
                        <h1>Grupos do usuário</h1>                     
                      </mat-card-header>
                      <mat-card-content>   
        
                        <mat-list *ngIf="aGrupo.length > 0"> 
        
                          <mat-list-item *ngFor= "let grp of aGrupo; let i=index" > 
        
                            <mat-icon mat-list-icon>group</mat-icon>   
                          
                            <mat-form-field class="example-full-width campo ">
                              <mat-label>E-mail</mat-label>
                              <input matInput placeholder="Email"  id="vEmail" formControlName="vEmail" >
                              <mat-icon matSuffix >email</mat-icon>  
                            </mat-form-field>
            
                            <button mat-icon-button color="primary"   >
                              <mat-icon>edit</mat-icon>
                            </button>           
        
                          </mat-list-item>
        
                        </mat-list>   
                      </mat-card-content> 
                </mat-card>
                --> 

<!--
<mat-card class="mat-elevation-z5"  *ngIf="onEdit"  >   
    <mat-card-header>
      <h1>Grupos do usuário</h1>                     
    </mat-card-header>
    <mat-card-content>   

      <mat-list *ngIf="aGrupo.length > 0"> 

        <mat-list-item *ngFor= "let grp of aGrupo; let i=index" > 

          <mat-icon mat-list-icon>group</mat-icon>   
        
              <mat-form-field class="  espacocampo">
                <mat-label>Código</mat-label>
                <input matInput placeholder="CodGrupo"   name="grp.grupo" [(ngModel)]="grp.grupo" [value]="grp.grupo"  > 
              </mat-form-field> 

              <button mat-icon-button color="primary"  (click)="atualizaAgrupos(i)" >  
                <mat-icon>search</mat-icon>
              </button>   

              <mat-form-field class="example-full-width espacocampo">
                <mat-label>Descrição</mat-label>
                <input matInput placeholder="DescGrupo" disabled   name="grp.descricao" [value]="grp.descricao"   >                       
              </mat-form-field>  
 

        </mat-list-item>

      </mat-list>   
    </mat-card-content> 
</mat-card> 
-->



<!--    <mat-list *ngIf="simpleReqUsersObs$ | async as users">  


          <mat-list-item *ngFor="let u of users; let i=index">
            <mat-icon mat-list-icon>person</mat-icon>              
            <p mat-line>Nome: {{u.nome}} - Email: {{u.email}}</p> 

            <button mat-icon-button color="warn" >
              <mat-icon>delete</mat-icon>
            </button>

            <button mat-icon-button color="primary" (click)="editUser(u)">
              <mat-icon>edit</mat-icon>
            </button>           

          </mat-list-item> 

        </mat-list>
        
        <br>
        <br>

        Com array
-->


        <!--  GRID de usuarios-->
        <!-- 
        <mat-list *ngIf="aUsers.length > 0"> 

          <mat-list-item *ngFor="let us of aUsers; let i=index"> 

            <mat-icon mat-list-icon>person</mat-icon>              
            <p mat-line>Nome: {{us.nome}} - Email: {{us.email}} - Id: {{us.id}}</p>  

   
             
            <button mat-icon-button color="primary"   (click)="editUser(us)">  
              <mat-icon>edit</mat-icon>
            </button>           

          </mat-list-item>

        </mat-list>

           // Apenas documentacao
           <button mat-icon-button color="warn"  (click)="del(us)"> 
            
                <button mat-icon-button color="warn"  (click)="openDialog(us)">  

                    <mat-icon>delete</mat-icon>
                  </button>
            --> 
   
         
         <!--  Table de manutenção de usuarios--> 